import React, {PropTypes} from 'react'
import { Link } from 'react-router-dom'
import {Pagination, Button, ButtonGroup, DropdownButton, MenuItem} from 'react-bootstrap'
var axios = require('axios');

var imageStyles={
    height:'500px',
}


class Actors extends React.Component{
  constructor(props){
    super(props);
      this.state = {
	  actors: [],
          numPages: 1,
          activePage:1,
	  orderBy: 'name',
      }
      this.handleSelectSort = this.handleSelectSort.bind(this);
      this.handleSelect = this.handleSelect.bind(this);

  }


  componentDidMount(){
      return axios.get('http://marvelus.me/api/actor',{params:{results_per_page:6, page:this.state.activePage, q:{"order_by":[{"field":this.state.orderBy,"direction":"asc"}]}}}).then(res=>{
	  this.state.numPages = res.data.total_pages;
	  const actors = res.data.objects.map(actor => actor)
	  this.setState({actors});
      });
  }

handleSelect(eventKey) {
   
    this.setState({
	activePage: eventKey,
    });

    axios.get('http://marvelus.me/api/actor', {params:{results_per_page:6, page:this.state.activePage, q:{"order_by":[{"field":this.state.orderBy,"direction":"asc"}]}}}).then(res=>{
	const actors = res.data.objects.map(actor => actor);
	this.setState({actors});

    });
}

    handleSelectSort(eventKey) {
	this.state.orderBy = eventKey;
	axios.get('http://marvelus.me/api/actor', {params:{results_per_page:6, page:this.state.activePage, order_by:this.state.orderBy}}).then(res=>{
	const actors = res.data.objects.map(actor => actor);
	this.setState({actors});
    });

    }

    renderDropdownButton(title, i) {
  return (
	  <DropdownButton bsStyle={title.toLowerCase()} title={title} key={"name"} id={`dropdown-basic-${i}`} onSelect={this.handleSelectSort}>
      <MenuItem eventKey="name">Name</MenuItem>
      <MenuItem eventKey="birthday">Age</MenuItem>
   
    </DropdownButton>
  );
}

    
   
    render() {
	
      return(
	  
	      <div className="container" styles="margin-top:100px;">
	  
	      <div className='text-center'>
	  {!this.state.numPages 
          ? null
           : <Pagination
	   bsSize='large'
              prev
              next
              first
              last
              ellipsis
              boundaryLinks
              items={this.state.numPages}
              maxButtons={10}
              activePage={this.state.activePage}
	      onSelect={this.handleSelect}/>
          }

	  {this.renderDropdownButton("Sort By: ", "name")}
	  
	  </div>
          <div className="row">
              {this.state.actors.map(actor =>
                <div className="col-sm-4">
                  <div className="panel panel-info">
                    <div className="panel-heading"><Link to={"/actor/" + actor.id}>{actor.name}</Link></div>
				     <div className="panel-body"><img src={"https://image.tmdb.org/t/p/w640/" + actor.image} className="img-responsive" style={imageStyles} alt="Image" /></div>
                  </div>
                </div>
				    )}

	 
          </div>
	   
          </div>
        );
  }
}

export default Actors
